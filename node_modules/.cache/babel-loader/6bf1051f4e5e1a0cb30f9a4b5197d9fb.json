{"ast":null,"code":"/* canvas-toBlob.js\r\n * A canvas.toBlob() implementation.\r\n * 2016-05-26\r\n * \r\n * By Eli Grey, http://eligrey.com and Devin Samarin, https://github.com/eboyjr\r\n * License: MIT\r\n *   See https://github.com/eligrey/canvas-toBlob.js/blob/master/LICENSE.md\r\n */\n\n/*global self */\n\n/*jslint bitwise: true, regexp: true, confusion: true, es5: true, vars: true, white: true,\r\n  plusplus: true */\n\n/*! @source http://purl.eligrey.com/github/canvas-toBlob.js/blob/master/canvas-toBlob.js */\n(function (view) {\n  \"use strict\";\n\n  var Uint8Array = view.Uint8Array,\n      HTMLCanvasElement = view.HTMLCanvasElement,\n      canvas_proto = HTMLCanvasElement && HTMLCanvasElement.prototype,\n      is_base64_regex = /\\s*;\\s*base64\\s*(?:;|$)/i,\n      to_data_url = \"toDataURL\",\n      base64_ranks,\n      decode_base64 = function decode_base64(base64) {\n    var len = base64.length,\n        buffer = new Uint8Array(len / 4 * 3 | 0),\n        i = 0,\n        outptr = 0,\n        last = [0, 0],\n        state = 0,\n        save = 0,\n        rank,\n        code,\n        undef;\n\n    while (len--) {\n      code = base64.charCodeAt(i++);\n      rank = base64_ranks[code - 43];\n\n      if (rank !== 255 && rank !== undef) {\n        last[1] = last[0];\n        last[0] = code;\n        save = save << 6 | rank;\n        state++;\n\n        if (state === 4) {\n          buffer[outptr++] = save >>> 16;\n\n          if (last[1] !== 61\n          /* padding character */\n          ) {\n              buffer[outptr++] = save >>> 8;\n            }\n\n          if (last[0] !== 61\n          /* padding character */\n          ) {\n              buffer[outptr++] = save;\n            }\n\n          state = 0;\n        }\n      }\n    } // 2/3 chance there's going to be some null bytes at the end, but that\n    // doesn't really matter with most image formats.\n    // If it somehow matters for you, truncate the buffer up outptr.\n\n\n    return buffer;\n  };\n\n  if (Uint8Array) {\n    base64_ranks = new Uint8Array([62, -1, -1, -1, 63, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, -1, -1, -1, 0, -1, -1, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, -1, -1, -1, -1, -1, -1, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51]);\n  }\n\n  if (HTMLCanvasElement && (!canvas_proto.toBlob || !canvas_proto.toBlobHD)) {\n    if (!canvas_proto.toBlob) canvas_proto.toBlob = function (callback, type\n    /*, ...args*/\n    ) {\n      if (!type) {\n        type = \"image/png\";\n      }\n\n      if (this.mozGetAsFile) {\n        callback(this.mozGetAsFile(\"canvas\", type));\n        return;\n      }\n\n      if (this.msToBlob && /^\\s*image\\/png\\s*(?:$|;)/i.test(type)) {\n        callback(this.msToBlob());\n        return;\n      }\n\n      var args = Array.prototype.slice.call(arguments, 1),\n          dataURI = this[to_data_url].apply(this, args),\n          header_end = dataURI.indexOf(\",\"),\n          data = dataURI.substring(header_end + 1),\n          is_base64 = is_base64_regex.test(dataURI.substring(0, header_end)),\n          blob;\n\n      if (Blob.fake) {\n        // no reason to decode a data: URI that's just going to become a data URI again\n        blob = new Blob();\n\n        if (is_base64) {\n          blob.encoding = \"base64\";\n        } else {\n          blob.encoding = \"URI\";\n        }\n\n        blob.data = data;\n        blob.size = data.length;\n      } else if (Uint8Array) {\n        if (is_base64) {\n          blob = new Blob([decode_base64(data)], {\n            type: type\n          });\n        } else {\n          blob = new Blob([decodeURIComponent(data)], {\n            type: type\n          });\n        }\n      }\n\n      callback(blob);\n    };\n\n    if (!canvas_proto.toBlobHD && canvas_proto.toDataURLHD) {\n      canvas_proto.toBlobHD = function () {\n        to_data_url = \"toDataURLHD\";\n        var blob = this.toBlob();\n        to_data_url = \"toDataURL\";\n        return blob;\n      };\n    } else {\n      canvas_proto.toBlobHD = canvas_proto.toBlob;\n    }\n  }\n})(typeof self !== \"undefined\" && self || typeof window !== \"undefined\" && window || this.content || this);","map":null,"metadata":{},"sourceType":"script"}